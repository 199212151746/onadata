{% extends "ui_base.html" %}
{% block head %}
<style type="text/css" media="screen">
	#image-nav {
		display: none;
		padding: 3px 20px;
		height: 150px;
	}
	#image-nav .image-iwrap {
		width: 100%;
		overflow: auto;
		height: 130px;
	}
	#image-nav ul {
		width: 999em;
	}
	#image-nav li {
		list-style-type: none;
		margin-right: 8px;
	}
	.img-wrap {
		background-color: #666;
		width: 100px;
		height: 100px;
		border: 1px solid black;
		float: left;
	}
	#column-description {
		padding: 20px 10px;
		background-color: rgba(0,0,0,0.1);
		margin-top: 20px;
	}
	.column-data-wrap {}
	.column-data {
		margin: 4px 12px;
		color: #fff;
		background-color: rgba(0,0,0,0.5);
		border: 0 none;
		border-radius: 3px;
	}
	.col-info {
		margin: 2px 5px;
	}
	.col-info h2 {
		margin: 2px 0;
	}
	.col-info h3.description {
		margin: 2px 0;
		text-decoration: underline;
	}
	.sn-wrap {
		position: absolute;
		top: 200px;
		left: 0;
		z-index: 99;
	}
	.sn {
		margin: 3px 7px;
		background-color: #fff;
		width: 185px;
		padding: 6px 3px;
	}
	.sn ul {
		margin: 0;
		padding-left: 20px;
	}
	.sn ul ul {
		padding-left: 10px;
	}
	#facility-tabs.hide-tds td, #facility-tabs.hide-tds th {
		display: none;
	}
	#facility-tabs.hide-tds .show-me {
		display: table-cell;
	}
	
	/*--
	Right display div for facility popup
	--*/
	.rd-wrap {
		height: 65%;
		right: 0;
		position: absolute;
		z-index: 99
	}
	.right-div {
		background-color: #fff;
		margin: 4px 5px 5px 0;
	}
	.sub-sector-list {
		padding: 3px 0 16px;
	}
	.sub-sector-list span {
		color: #666;
	}
	.sub-sector-list a {
		padding: 3px 8px;
		color: #666;
		text-decoration: none;
		border-radius: 3px;
/*		text-decoration: none;
		border: 1px solid #999;
		color: #444;
		background-color: #eee;
		padding: 2px 6px;
		border-radius: 3px; */
	}
	.sub-sector-list a:hover {
		color: #333;
		background-color: #ddd;
	}
	.sub-sector-list a.selected {
		color: #000;
		background-color: #ccc;
	}
	.profile-data-wrap {
		position: absolute;
		top: 0;
		left: 50px;
		z-index: 15;
	}
	.profile-data {
		padding: 4px;
		margin: 5px 12px;
		background-color: rgba(255,255,255,0.9);
		height: 175px;
		overflow: auto;
	}
	.profile-data h2 {
		margin: 3px 0;
	}
	.profile-data h3 {
		margin: 2px 0;
	}
    .profile-data.hidden {
        display: none;
    }
	#header .toggle-button {
		color: #eee;
		text-decoration: none;
		padding: 4px 13px;
		font-size: 13px;
		opacity: 0.8;
	}
	div.toggleable {
		display: block;
	}
	div.toggleable.hidden {
		display: none;
	}
	#header .toggle-button.toggled {
		opacity: 1;
	}
	#lga-facilities-table.hidden {
		display: none;
	}
	#lga-facilities-table th {
		background-color: #d4ebfa;
	}
	#lga-facilities-table th.clickable {
		background-color: #bde0f8;
		border: 2px solid;
		border-color: #d9edfb #9bb8cb #95b1c3 #cee8fa;
	}
	#lga-facilities-table th.selected-column {
		background-color: #afd1e9;
		border-color: #a5c4d9 #c4e2f7 #c4e2f7 #90aabd;
	}
	.no-select {
		user-select: none;
		-o-user-select: none;
		-moz-user-select: none;
		-khtml-user-select: none;
		-webkit-user-select: none;
	}
	div.display-box {
		background-color: #fff;
	}
	div.display-box .occurrences {
		margin-left: 4px;
		font-size: 11px;
	}
	div.display-box * {
		margin: 0;
	}
	div.db-l-w, div.db-r-w {
		width: 50%;
		float: left;
	}
	div.db-r-w  {
		float: right;
	}
	div.db-l, div.db-r {
		margin: 5px 12px 5px;
	}
	div.db-r {
		margin-left: 0;
	}
	div.db-l .db-l-content {
		margin-top: 4px;
	}
	div.db-l h2.db-title {
		padding: 3px 0 4px;
		font-size: 15px;
	}
	div.db-r, div.db-l h2.db-title, div.db-l .db-l-content {
		color: #000;
		background-color: rgba(255,255,255,0.7);
	}
	div.db-r div.content {
		margin: 3px 6px;
	}
	div.db-r {
		overflow: auto;
		height: 100px;
	}
</style>
<link rel="stylesheet" href="/static/openlayers/default/style.css" type="text/css" media="all" charset="utf-8">
{% endblock %}
{% block content %}
<div class='content-inner-wrap'>
	<div class="widget-outer-wrap" style="bottom:0">
		<div class="fullw-widget">
			<div id="lga-facilities-table"></div>
		</div>
	</div>
	<div id="map" class="resizing-map"></div>
</div>
<div id="gap-analysis-table-template" style="display:none">
	<div>
	<h2>Health</h2>
	<table class="gap-analysis">
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="3">
					Facilities Per Population
				</td>
				<td>
					Insitutional Delivery
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_institutional_delivery_only"></td>
				<td class="fill-me centered" data-variable-slug="target_health_facilities_institutional_delivery_only"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_institutional_delivery_only"></td>
			</tr>
			<tr>
				<td>
					Basic EmOC
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_basic_emoc_fully_functional"></td>
				<td class="fill-me centered" data-variable-slug="target_health_facilities_basic_emoc"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_basic_emoc"></td>
			</tr>
			<tr>
				<td>
					Comprehensive EmOC
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_comprehensive_emoc_fully_functional"></td>
				<td class="fill-me centered" data-variable-slug="target_health_facilities_comprehensive_emoc"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_comprehensive_emoc"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="5">
					Infrastructure
				</td>
				<td>
					Emergency Transport
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_functioning_emergency_transport"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_emergency_transport"></td>
			</tr>	
			<tr>
				<td>
					Mobile Communications
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_functioning_mobile_and_coverage"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_functioning_mobile_communications"></td>
			</tr>
			<tr>
				<td>
					Improved Water
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_potable_water_past_mth"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_potable_water"></td>
			</tr>
			<tr>
				<td>
					Improved Sanitation
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_functioning_improved_sanitation"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_functioning_improved_sanitation"></td>
			</tr>
			<tr>
				<td>
					Power
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_power_access_and_functional"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_power_access_and_funtional"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="3">
					Equipment, Drugs &amp; Diagnostics
				</td>
				<td>
					Minimum Equipment Package
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_min_equipment_package"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_with_min_equip_package"></td>
			</tr>
			<tr>
				<td>
					Minimum Essential Medications
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_min_essential_meds"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_with_min_essential_meds"></td>
			</tr>
			<tr>
				<td>
					Minimum Laboratory Diagnostics
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_min_lab_diagnostics"></td>
				<td class="fill-me centered" data-variable-slug="num_all_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_minimum_lab_diagnostics"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="4">
					Malaria
				</td>
				<td>
					Facilities with ITNs
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_itns"></td>
				<td class="fill-me centered" data-variable-slug="num_all_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_with_itns"></td>
			</tr>
			<tr>
				<td>
					Facilities with RDT
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_malaria_testing"></td>
				<td class="fill-me centered" data-variable-slug="num_all_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_with_malaria_testing"></td>
			</tr>
			<tr>
				<td>
					Facilities with ACT
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_artemisinin_for_malaria"></td>
				<td class="fill-me centered" data-variable-slug="num_all_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_with_artemisinin_for_malaria"></td>
			</tr>
			<tr>
				<td>
					Facilities with SP
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_with_malaria_treatment_sulphadoxine"></td>
				<td class="fill-me centered" data-variable-slug="num_all_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_with_sulphadoxine_for_malaria"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="1">
					Vaccination
				</td>
				<td>
					Routine Immunization
				</td>
				<td class="fill-me centered" data-variable-slug="num_health_facilities_routine_immunization"></td>
				<td class="fill-me centered" data-variable-slug="num_all_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_health_facilities_routine_immunization"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="5">
					Staffing
				</td>
				<td>
					Physicians
				</td>
				<td class="fill-me centered" data-variable-slug="num_hospitals_with_at_least_one_fulltime_doctor"></td>
				<td class="fill-me centered" data-variable-slug="num_hospitals"></td>
				<td class="fill-me centered" data-variable-slug="gap_hospitals_with_at_least_one_fulltime_doctor"></td>
			</tr>
			<tr>
				<td>
					Midwives and Nurse-midwives
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_care_with_min_3_midwives_and_nursemidwives"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_care_with_min_3_midwives_and_nursemidwives"></td>
			</tr>
			<tr>
				<td>
					Nurses
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_care_with_min_2_nurses_fulltime"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_care_with_min_2_nurses"></td>
			</tr>
			<tr>
				<td>
					Senior CHEWs
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_care_with_min_4_sr_chews"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_health_facility_with_min_4_sr_CHEW"></td>
			</tr>
			<tr>
				<td>
					Junior CHEWs
				</td>
				<td class="fill-me centered" data-variable-slug="num_basic_facilities_with_min_1_jr_chew"></td>
				<td class="fill-me centered" data-variable-slug="num_basic_health_facilities"></td>
				<td class="fill-me centered" data-variable-slug="gap_basic_primary_with_min_1_jr_chew"></td>
			</tr>
		</tbody>
	</table>
	<h2>Education</h2>
	<table class="gap-analysis">
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="3">
					Schools &amp; Classrooms
				</td>
				<td>
					Schools
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools"></td>
				<td class="fill-me centered" data-variable-slug="target_num_primary_schools"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_schools"></td>
			</tr>
			<tr>
				<td>
					Classrooms
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_classrooms_good_cond"></td>
				<td class="fill-me centered" data-variable-slug="target_num_primary_classrooms"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_school_classrooms_good_cond"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="3">
					Infrastructure
				</td>
				<td>
					Water
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools_with_potable_water"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_schools_potable_water"></td>
			</tr>
			<tr>
				<td>
					Sanitation
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools_with_improved_sanitation_functioning"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_schools_improved_sanitation_functioning"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="3">
					Furniture
				</td>
				<td>
					Chalkboards
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools_with_chalkboards_each_classroom"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_schools_with_chalkboards_each_classroom"></td>
			</tr>
			<tr>
				<td>
				    Benches
				</td>
				<td class="fill-me centered" data-variable-slug="primary_school_benches"></td>
				<td class="fill-me centered" data-variable-slug="sum_target_primary_school_benches"></td>
				<td class="fill-me centered" data-variable-slug="gap_benches_primary_schools"></td>
			</tr>
			<tr>
				<td>
			        Desks
				</td>
				<td class="fill-me centered" data-variable-slug="primary_school_desks"></td>
				<td class="fill-me centered" data-variable-slug="sum_target_primary_school_desks"></td>
				<td class="fill-me centered" data-variable-slug="gap_desks_primary_schools"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="4">
					Teaching Materials
				</td>
				<td>
					Textbooks
				</td>
				<td class="fill-me centered" data-variable-slug="primary_school_textbooks"></td>
				<td class="fill-me centered" data-variable-slug="sum_target_primary_school_textbooks"></td>
				<td class="fill-me centered" data-variable-slug="gap_textbooks_primary_schools"></td>
			</tr>
			<tr>
				<td>
					Excercise Books
				</td>
				<td class="fill-me centered" data-variable-slug="primary_school_exercise_books"></td>
				<td class="fill-me centered" data-variable-slug="sum_target_primary_school_exercise_books"></td>
				<td class="fill-me centered" data-variable-slug="gap_exercise_books_primary_schools"></td>
			</tr>
			<tr>
				<td>
					Pens/Pencils
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools_with_sufficient_pens"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_schools_with_sufficient_pens"></td>
			</tr>
			<tr>
				<td>
					Teaching Toolkits
				</td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools_natl_curriculum_and_teaching_kit"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_schools"></td>
				<td class="fill-me centered" data-variable-slug="gap_primary_schools_natl_curriculum_and_teaching_kit"></td>
			</tr>
		</tbody>
		<tbody>
			<tr>
				<td colspan="2" class="blank"></td>
				<td>Current</td>
				<td>Target</td>
				<td>Gap</td>
			</tr>
			<tr>
				<td rowspan="1">
					Staff
				</td>
				<td>
					Qualified Teachers
				</td>
				<td class="fill-me centered" data-variable-slug="primary_school_teachers_qualified"></td>
				<td class="fill-me centered" data-variable-slug="num_primary_classrooms_good_cond"></td>
				<td class="fill-me centered" data-variable-slug="gap_qualified_teachers_primary_schools"></td>
			</tr>
		</tbody>
	</table>
	</div>
</div>
{% endblock %}
{% block js %}
<script src="/static/js/application.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/js/launch-open-layers.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
<!--

var debugMode = false;

var pageRootUrl = "/~";

var defaultSectorSlug = 'health';

var loadMap = true;
//var loadMap = $("input#load-map").attr('checked');

-->
</script>
<script src="/static/js/lga-dashboard.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
<!--

$('.content-inner-wrap').css({'padding':0});
$(function(){
	var dashboard = $.sammy(function(){
		function createTitleForLga(state, lga) {
			return $("<span />").text("NMIS: ")
				.append($("<span />", {'class': 'state-name'}).text(state))
				.append($("<span />").text(' - '))
				.append($("<span />", {'class': 'lga-name'}).text(lga));
		}
		
		this.get(pageRootUrl, function(){
			setTitle($("<span />", {'text': 'NMIS'}));
			launchOpenLayers({
				defaultLayer: '',
				layers: [
				    ["Nigeria", "nigeria_base"],
				    ["Nigeria health workers per thousand people", "nigeria_healthworkers_per_thousand"],
				    ["Nigeria Health Facilities with Institutional Deliveries", "pct_healthfacilities_with_institutional_delivery"],
				    ["Nigeria No Stockouts of Bednets or Malaria Medicine", "nigeria_pct_no_bednet_malmeds_oneweek"],
				    ["Nigeria Classrooms That Need Repair", "nigeria_pct_classroom_need_repair"],
				    ["Nigeria classrooms with proportion student to teacher ratio > 40", "nigeria_prop_ratio_greater_than_40"],
				    ["Nigeria Immunization Rate", "nigearia_immunization_rate"],
				    ["Nigeria Under 5 Mortality Rate", "nigeria_under5_mortality_rate"],
				    ["Nigeria Child Wasting", "nigeria_wasting"],
				    ["Nigeria Child Health", "nigeria_child_health"],
				    ["Nigeria Child Nutrition", "nigeria_child_nutrition"],
				    ["Nigeria Maternal Health", "nigeria_maternal_health"],
				    ["Nigeria Primary Education Enrollment", "nigeria_primary_education_enrollment"]
		        ]
			});
		});
		
		function addToggleLinks(){
			var profileDataLink = $('<a />', {'href':'#'})
					.addClass('toggle-button')
					.text('[LGA]')
					.click(function(e){
						$('.profile-data').toggleClass('hidden')
						profileDataLink.toggleClass('hidden');
						return false;
					});
			var facilityTableLink = $('<a />', {'href':'#'})
					.addClass('toggle-button')
					.text('[FACILITIES]')
					.click(function(e){
						$('#lga-facilities-table').toggleClass('hidden');
						facilityTableLink.toggleClass('hidden');
						return false;
					});
			var gapAnalysisLink = $('<a />', {href: '#'})
					.addClass('toggle-button')
					.text('[GAP ANALYSIS]')
					.click(function(e){
						$('.gap-analysis-table-wrap')
							.addClass('toggleable')
							.toggleClass('hidden');
						gapAnalysisLink.toggleClass('hidden');
						return false;
					});
			$('#header .title')
					.append(profileDataLink)
					.append(gapAnalysisLink)
					.append(facilityTableLink);
		}
		this.get(pageRootUrl + ":lga/(.+)", function(){
			var lgaId = this.params.lga;
			this.params.splat.length !== 1 && warn("Sammy needs some help selecting a sector.");
			var fullSectorId = this.params.splat[0];
			lga.loadData(lgaId,
							function(){
								this.buildTable = true;
								var t = createTitleForLga(this.stateName, this.lgaName);
								setTitle(t);
								this.trigger('select-sector', {
									fullSectorId: fullSectorId
								});
								addToggleLinks();
							});
		})
		this.get(pageRootUrl + ":lga", function(){
			var lgaId = this.params.lga;
			lga.loadData(lgaId,
							function(){
								this.buildTable = true;
								var t = createTitleForLga(this.stateName, this.lgaName);
								setTitle(t);
								addToggleLinks();
							});
		});
	});
	
	window._dashboard = dashboard;
	dashboard.run();
});

// SetResizer is defiend in application.js
//   its purpose is to trigger "full-height" whenever the page is resized.
//   it has some weird side-effects on mobile browsers.
SetResizer(jQuery, ".content-inner-wrap", "#header, #menu", 15);

-->
</script>
{% endblock %}
