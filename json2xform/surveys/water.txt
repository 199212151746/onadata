<%include file="preloads.txt"/>

<%include file="geopoint_picture.txt"/>

<%include file="location.txt"/>

[nearest locality] Which locality is this water scheme /source in or closest to? (string)

[nearest school or clinic] Which school or health clinic is this scheme /source closest to? (string)

[id] Please enter pre-existing ID number for this water point, if any. (string)
{
    "hint" : "Write none if there is no pre-existing ID number."
}

[type] What kind of water scheme/source is it? (select one)
{
    "choices" : {
        "Borehole" : "borehole",
        "Tube well" : "tube well",
        "Protected dug well" : "dug well",
        "Developed / protected spring water" : "spring water",
        "Developed and treated surface water" : "surface water",
        "Rainwater harvesting scheme" : "rainwater",
        "Other" : "other"
        }
    }

[distribution type] What is the type of distribution of the water scheme/source? (select one)
{
    "choices" : {
        "Single point (where the scheme is located)" : "single point",
        "Mulitple points less than 100m reticulation" : "multiple points 100m reticulation",
        "Multiple points less than 1km reticulation" : "multiple points <1km reticulation",
        "Multiple points more than 1km reticulation" : "multiple points >1km reticulation"
        }
    }

[lift mechanism] What is the lift mechanism? (select one)
{
    "choices" : {
        "Diesel pump" : "diesel pump",
        "Electric motor pump" : "electric motor pump",
        "Solar pump" : "solar pump",
        "Hand pump" : "hand pump",
        "Rope/pulley" : "rope and pulley",
        "Animal powered pump" : "animal powered pump",
        "Other" : "other",
        "Don't know" : "not known"
        }
    }

<%
    import json
    from txt2xform import sluggify

    organizations = {
        "Federal government" : "federal govt",
        "State government" : "state govt",
        "Local government" : "local govt",
        "Community" : "community",
        "Individual" : "individual",
        "International development partner" : "idp",
        "Private organization" : "private org",
        "Other" : "other",
        }

    conditions = {
        "Newly Constructed" : "new",
        "Not new but well maintained" : "well maintained",
        "Poorly maintained" : "poorly maintained",
        "Not applicable" : "not applicable",
        }

%>

[developed by] Who developed the water scheme/source? (select one)
{
    "choices" : ${ json.dumps(organizations) }
}

[managed by] Who manages the water scheme/source? (select all that apply)
{
    "choices" : ${ json.dumps(organizations) }
    }

% for k, v in organizations.items():
    [manager ${v}] Please specify the name of the managing entity from ${k}. (string)
    {
        "relevant" : "selected([managed by], '${sluggify(v)}')"
        }

% endfor

[pay for water] Do people have to pay for water from this water source/scheme? (yes or no)

[used today] Does it appear that this water source/scheme has been used today? (yes or no)

<%
    pump_types = ["diesel pump",
                  "electric motor pump",
                  "solar pump",
                  "hand pump",
                  "animal powered pump",
                  "other",]

    reasons = [
        ("pump broken", "the pump mechanism broken", " or ".join(["[lift mechanism]='%s'" % sluggify(type) for type in pump_types])),
        ("no diesel", "there is no diesel to run the pump", "[lift mechanism]='diesel_pump'"),
	("point broken", "the kiosk, tap or tank is broken", ""),
        ("poor water quality", "the water quality is too poor", ""),
        ("well dry", "the well is dry", "[type]='tube_well' or [type]='dug_well'"),]
%>

% for slug, reason, relevant in reasons:
    [not used ${slug}] Is this water source/scheme not in use because ${reason}? (yes no dont know)
    {
        % if relevant:
        "relevant" : "[used today]='no' and (${relevant})"
        % else:
        "relevant" : "[used today]='no'"
        %endif
        }

% endfor

[not used other] Please enter any other reasons this water source/scheme is not in use. (string)
{
    "relevant" : "[used today]='no'",
    "required" : "false()"
    }

[condition] What is the condition of the water source/scheme's physical infrastructure? (select one)
{
    "choices" : ${ json.dumps(conditions) }
    }

[nearby potable water] Is there another safe / drinkable source of water within 1km of this water scheme/source? (yes or no)

[pattern of use] At which times of the year is this water scheme/source used? (select one)
{
    "choices" : {
        "It is used year round/all seasons" : "year round",
        "It is used only during the dry seasons" : "dry seasons",
        "It is used only during the wet seasons" : "wet seasons",
        "It has another pattern of use" : "no pattern",
        "Don't know" : "not known"
        }
    }
